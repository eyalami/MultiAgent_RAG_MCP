#!/bin/sh
set -e

# Ensure TAVILY_API_KEY is set
if [ -z "$TAVILY_API_KEY" ]; then
  echo "Error: TAVILY_API_KEY is not set"
  exit 1
fi

echo "Starting preprocessing..."
python -m src.scripts.preprocess_kb

echo "Starting MCP proxy..."
# Run MCP proxy in background
npx -y mcp-remote "https://mcp.tavily.com/mcp/?tavilyApiKey=$TAVILY_API_KEY" --host 0.0.0.0 --port 4000 &
MCP_PID=$!

echo "Starting FastAPI server..."
exec gunicorn src.main:app \
    -k uvicorn.workers.UvicornWorker \
    --bind 0.0.0.0:80 \
    --workers=${WORKERS:-1} \
    --threads=${THREADS:-1} \
    --timeout=${TIMEOUT:-300} \
    --access-logfile=- \
    --error-logfile=- \
    --log-level debug \
    --capture-output \
    -c gunicorn_conf.py

# Optional: trap signals to kill MCP proxy when container stops
trap "kill $MCP_PID" SIGTERM SIGINT



INFO:src.agents.mcp_agent:{"results":[{"url":"https://medium.com/cantors-paradise/a-mathematician-at-the-movies-mean-girls-15eff91f3f6c","title":"A Mathematician at the Movies: Mean Girls | by StephenwithaPhD | Cantor’s Paradise","raw_content":"[Sitemap](/sitemap/sitemap.xml)\n\n[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F15eff91f3f6c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=mobileNavBar&source=post_page---top_nav_layout_nav-----------------------------------------)\n\n[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fwww.cantorsparadise.com%2Fa-mathematician-at-the-movies-mean-girls-15eff91f3f6c&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)\n\n[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fwww.cantorsparadise.com%2Fa-mathematician-at-the-movies-mean-girls-15eff91f3f6c&source=post_page---top_nav_layout_nav-----------------------global_nav------------------)\n\n[## Cantor’s Paradise](https://www.cantorsparadise.com/?source=post_page---publication_nav-28ba84190b27-15eff91f3f6c---------------------------------------)\n\n·\n\nMedium’s #1 Math Publication\n\nMember-only story\n\n# **A Mathematician at the Movies: Mean Girls**\n\n8 min readJul 22, 2021\n\nA few nights ago my partner had me sit down and watch the movie “Mean Girls” with her. For those unfamiliar, near the end of the film, the lead character is involved in a math competition in which two teams face off to answer questions for the state championship. We hear three of the questions the contestants are challenged with, after which my partner turned to me and asked if any of them made any sense. Quite often in movies when some sort of math, or any other science, is used, some random equation is thrown in to sound and look the part, even when it has no relevance to the topic being discussed. I thought it would be an enjoyable project to look into these appearances in movies and question whether they do make sense and, if so, what do they mean. There seems no better place to start than with mean girls. Below are the three questions asked to the contestants if you would like to try them yourself. I give my solutions a little further down.\n\n**Question 1**  \nTwice the larger of two numbers is three more than five times the smaller and the sum of four times the larger and three times the smaller is 71. What are the numbers?\n\n**Question 2**  \nFind an odd three digit number whose digits add up to 12. The digits are all different and the difference between the first two digits equals the difference between the last two digits.\n\nActually, in the film the host of the quiz is interrupted by a contestant with the answer before he completes this question…\n\n## Create an account to read the full story.\n\nThe author made this story available to Medium members only.  \nIf you’re new to Medium, create a new account to read this story on us.\n\n[Continue in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F15eff91f3f6c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&%7Estage=regwall&source=-----15eff91f3f6c---------------------post_regwall------------------)\n\nOr, continue in mobile web\n\n[Sign up with Google](//medium.com/m/connect/google?state=google-%7Chttps%3A%2F%2Fwww.cantorsparadise.com%2Fa-mathematician-at-the-movies-mean-girls-15eff91f3f6c%3Fsource%3D-----15eff91f3f6c---------------------post_regwall------------------%26skipOnboarding%3D1%7Cregister&source=-----15eff91f3f6c---------------------post_regwall------------------)\n\n[Sign up with Facebook](//medium.com/m/connect/facebook?state=facebook-%7Chttps%3A%2F%2Fwww.cantorsparadise.com%2Fa-mathematician-at-the-movies-mean-girls-15eff91f3f6c%3Fsource%3D-----15eff91f3f6c---------------------post_regwall------------------%26skipOnboarding%3D1%7Cregister&source=-----15eff91f3f6c---------------------post_regwall------------------)\n\nAlready have an account? [Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fwww.cantorsparadise.com%2Fa-mathematician-at-the-movies-mean-girls-15eff91f3f6c&source=-----15eff91f3f6c---------------------post_regwall------------------)\n\n[## Published in Cantor’s Paradise](https://www.cantorsparadise.com/?source=post_page---post_publication_info--15eff91f3f6c---------------------------------------)\n\n[39K followers](/followers?source=post_page---post_publication_info--15eff91f3f6c---------------------------------------)\n\n·[Last published just now](/the-easy-way-of-calculating-laplace-transforms-a8f3965a6a0c?source=post_page---post_publication_info--15eff91f3f6c---------------------------------------)\n\nMedium’s #1 Math Publication\n\n[## Written by StephenwithaPhD](https://stephenwithaphd.medium.com/?source=post_page---post_author_info--15eff91f3f6c---------------------------------------)\n\n[1.7K followers](https://stephenwithaphd.medium.com/followers?source=post_page---post_author_info--15eff91f3f6c---------------------------------------)\n\n·[18 following](https://medium.com/@stephenwithaphd/following?source=post_page---post_author_info--15eff91f3f6c---------------------------------------)\n\nMathematics enthusiast trying his hand at writing.\n\n## Responses (1)\n\nWrite a response\n\n[What are your thoughts?](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fwww.cantorsparadise.com%2Fa-mathematician-at-the-movies-mean-girls-15eff91f3f6c&source=---post_responses--15eff91f3f6c---------------------respond_sidebar------------------)\n\n[Lfsequeira](https://medium.com/@lfsequeira?source=post_page---post_responses--15eff91f3f6c----0-----------------------------------)\n\n[Jul 15, 2023](https://medium.com/@lfsequeira/i-dont-know-if-you-are-just-trying-to-be-very-thorough-but-your-answers-to-these-questions-seem-46217301a83b?source=post_page---post_responses--15eff91f3f6c----0-----------------------------------)\n\n```\n\n\nI don’t know if you are just trying to be very thorough, but your answers to these questions seem overly complicated, particularly the second one- and some of the observations you make there are incorrect. You seem to at a point have forgotten the…\n\n\n```\n\n## More from StephenwithaPhD and Cantor’s Paradise\n\nIn\n\n[Cantor’s Paradise](https://www.cantorsparadise.com/?source=post_page---author_recirc--15eff91f3f6c----0---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\nby\n\n[StephenwithaPhD](https://stephenwithaphd.medium.com/?source=post_page---author_recirc--15eff91f3f6c----0---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\n[## 14 Interesting Math Facts\n\n### In this article, I present 14 interesting math facts that I have gathered over the past few years of teaching. I generally present a…](/14-interesting-math-facts-3dd5ae820969?source=post_page---author_recirc--15eff91f3f6c----0---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\nJun 25, 2021\n\n[1.3K\n\n17](/14-interesting-math-facts-3dd5ae820969?source=post_page---author_recirc--15eff91f3f6c----0---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\nIn\n\n[Cantor’s Paradise](https://www.cantorsparadise.com/?source=post_page---author_recirc--15eff91f3f6c----1---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\nby\n\n[Kasper Müller](https://kaspermuller.medium.com/?source=post_page---author_recirc--15eff91f3f6c----1---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\n[## The Most Magical Formula in The World: Exploring the Power of Residues\n\n### Taming infinite series through the power of complex numbers with the most surprising formula I have ever seen!](/complex-analysis-infinite-series-integration-formula-fcc9b73143b3?source=post_page---author_recirc--15eff91f3f6c----1---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\n5d ago\n\n[152\n\n4](/complex-analysis-infinite-series-integration-formula-fcc9b73143b3?source=post_page---author_recirc--15eff91f3f6c----1---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\nIn\n\n[Cantor’s Paradise](https://www.cantorsparadise.com/?source=post_page---author_recirc--15eff91f3f6c----2---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\nby\n\n[Kasper Müller](https://kaspermuller.medium.com/?source=post_page---author_recirc--15eff91f3f6c----2---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\n[## Numbers the Way God Intended: The Surreal Numbers\n\n### Are we using the wrong number system?](/numbers-the-way-god-intended-the-surreal-numbers-21ceb6e7219f?source=post_page---author_recirc--15eff91f3f6c----2---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\nAug 4\n\n[723\n\n17](/numbers-the-way-god-intended-the-surreal-numbers-21ceb6e7219f?source=post_page---author_recirc--15eff91f3f6c----2---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\nIn\n\n[Y(MATH)](https://medium.com/y-math?source=post_page---author_recirc--15eff91f3f6c----3---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\nby\n\n[StephenwithaPhD](https://stephenwithaphd.medium.com/?source=post_page---author_recirc--15eff91f3f6c----3---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\n[## What Level Can You Reach? The Surd/Radical Challenge.\n\n### Let’s play a game. I have 5 levels of surd-themed questions below. The game is, as you would expect, to start on level 1 (question 1) and…](https://medium.com/y-math/what-level-can-you-reach-the-surd-radical-challenge-e7d20d936832?source=post_page---author_recirc--15eff91f3f6c----3---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\nDec 8, 2022\n\n[17\n\n6](https://medium.com/y-math/what-level-can-you-reach-the-surd-radical-challenge-e7d20d936832?source=post_page---author_recirc--15eff91f3f6c----3---------------------d254c824_a3c1_4d8d_b759_01f2d4b2a3f0--------------)\n\n[See all from StephenwithaPhD](https://stephenwithaphd.medium.com/?source=post_page---author_recirc--15eff91f3f6c---------------------------------------)\n\n[See all from Cantor’s Paradise](https://www.cantorsparadise.com/?source=post_page---author_recirc--15eff91f3f6c---------------------------------------)\n\n## Recommended from Medium\n\n[Marco G](https://marcog.medium.com/?source=post_page---read_next_recirc--15eff91f3f6c----0---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\n[## December 21, 2025 Could Redefine Human History: 3I/ATLAS and the Release of Autonomous Probes on…\n\n### Sinaloa, Mexico — Declassified File / The Distants Division Ω\\_2025](https://marcog.medium.com/december-21-2025-could-redefine-human-history-3i-atlas-and-the-release-of-autonomous-probes-on-e50cbe306042?source=post_page---read_next_recirc--15eff91f3f6c----0---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\n4d ago\n\n[98\n\n10](https://marcog.medium.com/december-21-2025-could-redefine-human-history-3i-atlas-and-the-release-of-autonomous-probes-on-e50cbe306042?source=post_page---read_next_recirc--15eff91f3f6c----0---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\nIn\n\n[Generative AI](https://generativeai.pub/?source=post_page---read_next_recirc--15eff91f3f6c----1---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\nby\n\n[Adham Khaled](https://medium.com/@adhamhidawy?source=post_page---read_next_recirc--15eff91f3f6c----1---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\n[## Stanford Just Killed Prompt Engineering With 8 Words (And I Can’t Believe It Worked)\n\n### ChatGPT keeps giving you the same boring response? This new technique unlocks 2× more creativity from ANY AI model — no training required…](https://generativeai.pub/stanford-just-killed-prompt-engineering-with-8-words-and-i-cant-believe-it-worked-8349d6524d2b?source=post_page---read_next_recirc--15eff91f3f6c----1---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\nOct 19\n\n[16.3K\n\n370](https://generativeai.pub/stanford-just-killed-prompt-engineering-with-8-words-and-i-cant-believe-it-worked-8349d6524d2b?source=post_page---read_next_recirc--15eff91f3f6c----1---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\n[Len Rosen](https://medium.com/@rosen.len?source=post_page---read_next_recirc--15eff91f3f6c----0---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\n[## Artemis Timetable Involving SpaceX Hardware Continues To Slip\n\n### NASA, in its planned new mission to establish a permanent human presence on the Moon, chose SpaceX as a commercial partner for the Artemis…](https://medium.com/@rosen.len/artemis-timetable-involving-spacex-hardware-continues-to-slip-2084a5d29bb3?source=post_page---read_next_recirc--15eff91f3f6c----0---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\nOct 18\n\n[John P. Wilson](https://medium.com/@lanierwilson?source=post_page---read_next_recirc--15eff91f3f6c----1---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\n[## 3I/ATLAS Through the Lens of Logical Fallacies\n\n### 3I/ATLAS is not your garden variety celestial visitor. If it were, astrophysicists would catalogue it and go about their business while…](https://medium.com/@lanierwilson/3i-atlas-through-the-lens-of-logical-fallacies-93608a5601a6?source=post_page---read_next_recirc--15eff91f3f6c----1---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\n2d ago\n\n[154\n\n8](https://medium.com/@lanierwilson/3i-atlas-through-the-lens-of-logical-fallacies-93608a5601a6?source=post_page---read_next_recirc--15eff91f3f6c----1---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\nIn\n\n[Entrepreneurship Handbook](https://ehandbook.com/?source=post_page---read_next_recirc--15eff91f3f6c----2---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\nby\n\n[Joe Procopio](https://jproco.medium.com/?source=post_page---read_next_recirc--15eff91f3f6c----2---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\n[## AI Porn Is Here — and We’re All Pretending It’ll Be Fine\n\n### Sam Altman has decided that five years is enough of a head start for the porn companies](https://ehandbook.com/ai-porn-is-here-and-were-all-pretending-it-ll-be-fine-ba0fe40f1422?source=post_page---read_next_recirc--15eff91f3f6c----2---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\nOct 31\n\n[2.2K\n\n100](https://ehandbook.com/ai-porn-is-here-and-were-all-pretending-it-ll-be-fine-ba0fe40f1422?source=post_page---read_next_recirc--15eff91f3f6c----2---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\n[Avi Loeb](https://avi-loeb.medium.com/?source=post_page---read_next_recirc--15eff91f3f6c----3---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\n[## Is the New “Nearly Interstellar” Object C/2025 V1 Related to 3I/ATLAS?\n\n### In a Newsmax interview this morning (available here), I was asked about a new “nearly interstellar” object that was just discovered in the…](https://avi-loeb.medium.com/is-the-new-nearly-interstellar-object-c-2025-v1-related-to-3i-atlas-0f38a0baf494?source=post_page---read_next_recirc--15eff91f3f6c----3---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\n1d ago\n\n[1.1K\n\n47](https://avi-loeb.medium.com/is-the-new-nearly-interstellar-object-c-2025-v1-related-to-3i-atlas-0f38a0baf494?source=post_page---read_next_recirc--15eff91f3f6c----3---------------------83822685_d263_4117_94e6_333e5d0d7f34--------------)\n\n[See more recommendations](https://medium.com/?source=post_page---read_next_recirc--15eff91f3f6c---------------------------------------)\n\n[Text to speech](https://speechify.com/medium?source=post_page-----15eff91f3f6c---------------------------------------)","images":[]}],"failed_results":[],"response_time":0.0,"request_id":"5f845a25-114b-45c7-8de6-a3132561069c"}